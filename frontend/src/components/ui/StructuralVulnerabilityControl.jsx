import React from 'react';

/**
 * Structural Vulnerability Layer Control Component
 * Provides discrete earthquake intensity slider for users to select earthquake intensity to view
 */
const StructuralVulnerabilityControl = ({ 
  earthquakeIntensity, 
  onIntensityChange,
  disabled = false 
}) => {
  // Define discrete earthquake intensity options
  const intensityOptions = [
    { value: '3', label: 'Level 3' },
    { value: '4', label: 'Level 4' },
    { value: '5弱', label: '5 Lower' },
    { value: '5強', label: '5 Upper' },
    { value: '6弱', label: '6 Lower' },
    { value: '6強', label: '6 Upper' },
    { value: '7', label: 'Level 7' }
  ];

  // Find current selected option index
  const currentIndex = intensityOptions.findIndex(opt => opt.value === earthquakeIntensity);
  const validIndex = currentIndex >= 0 ? currentIndex : 0;

  const handleSliderChange = (e) => {
    const index = parseInt(e.target.value);
    onIntensityChange(intensityOptions[index].value);
  };

  return (
    <div style={{
      padding: '12px 16px',
      backgroundColor: '#f8f9fa',
      borderRadius: '6px',
      border: '1px solid #e0e0e0'
    }}>
      <div style={{
        fontSize: '13px',
        color: '#666',
        lineHeight: '1.4',
        marginBottom: '12px'
      }}>
        Select earthquake intensity to view structural collapse probability of buildings under that intensity
      </div>

      {/* Discrete earthquake intensity slider */}
      <div style={{ width: '100%' }}>
        <div style={{
          display: 'flex',
          justifyContent: 'space-between',
          alignItems: 'center',
          marginBottom: '8px'
        }}>
          <label style={{
            fontSize: '14px',
            fontWeight: '500',
            color: '#333'
          }}>
            Earthquake Intensity
          </label>
          <span style={{
            fontSize: '13px',
            color: '#d97706',
            backgroundColor: '#fef3e7',
            padding: '2px 8px',
            borderRadius: '4px',
            border: '1px solid #fdae6b',
            fontWeight: '600'
          }}>
            {intensityOptions[validIndex].label}
          </span>
        </div>

        <div style={{ position: 'relative', width: '100%' }}>
          <input
            type="range"
            min={0}
            max={intensityOptions.length - 1}
            step={1}
            value={validIndex}
            onChange={handleSliderChange}
            disabled={disabled}
            style={{
              width: '100%',
              height: '6px',
              borderRadius: '3px',
              background: `linear-gradient(to right, #d97706 0%, #d97706 ${(validIndex / (intensityOptions.length - 1)) * 100}%, #e0e0e0 ${(validIndex / (intensityOptions.length - 1)) * 100}%, #e0e0e0 100%)`,
              outline: 'none',
              appearance: 'none',
              cursor: disabled ? 'not-allowed' : 'pointer',
              opacity: disabled ? 0.5 : 1,
              WebkitAppearance: 'none'
            }}
          />

          <style>{`
            input[type="range"]::-webkit-slider-thumb {
              appearance: none;
              -webkit-appearance: none;
              width: 18px;
              height: 18px;
              border-radius: 50%;
              background: #d97706;
              border: 2px solid white;
              box-shadow: 0 2px 6px rgba(0,0,0,0.2);
              cursor: ${disabled ? 'not-allowed' : 'pointer'};
              transition: transform 0.2s ease;
            }

            input[type="range"]::-webkit-slider-thumb:hover {
              transform: ${disabled ? 'none' : 'scale(1.1)'};
            }

            input[type="range"]::-moz-range-thumb {
              width: 18px;
              height: 18px;
              border-radius: 50%;
              background: #d97706;
              border: 2px solid white;
              box-shadow: 0 2px 6px rgba(0,0,0,0.2);
              cursor: ${disabled ? 'not-allowed' : 'pointer'};
              border: none;
            }
          `}</style>
        </div>

        {/* Scale labels */}
        <div style={{
          display: 'flex',
          justifyContent: 'space-between',
          marginTop: '8px',
          fontSize: '10px',
          color: '#888'
        }}>
          {intensityOptions.map((option, index) => (
            <span 
              key={option.value}
              style={{
                color: index === validIndex ? '#d97706' : '#888',
                fontWeight: index === validIndex ? '600' : '400'
              }}
            >
              {option.label}
            </span>
          ))}
        </div>
      </div>
    </div>
  );
};

export default StructuralVulnerabilityControl;